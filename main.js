"use strict";var h=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var E=(o,e)=>{for(var t in e)h(o,t,{get:e[t],enumerable:!0})},x=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of c(e))!b.call(o,n)&&n!==t&&h(o,n,{get:()=>e[n],enumerable:!(i=d(e,n))||i.enumerable});return o};var N=o=>x(h({},"__esModule",{value:!0}),o);var L={};E(L,{default:()=>r});module.exports=N(L);var s=require("obsidian"),l=require("@codemirror/state"),a=require("@codemirror/view"),w={enabled:!0,position:"left",offset:40,align:"right"},r=class extends s.Plugin{constructor(){super(...arguments);this.lineNumberCompartment=new l.Compartment;this.positionCompartment=new l.Compartment;this.alignCompartment=new l.Compartment}async onload(){await this.loadSettings(),this.addSettingTab(new f(this.app,this));let t=[this.lineNumberCompartment.of(this.getLineNumbersExtension(this.settings.enabled)),this.positionCompartment.of(this.getPositionExtension(this.settings.position,this.settings.offset)),this.alignCompartment.of(this.getAlignExtension(this.settings.align))];this.registerEditorExtension(t),this.applyToAllOpenEditors()}getLineNumbersExtension(t){return t?(0,a.lineNumbers)():[]}getPositionExtension(t,i){let n="eln-ln-left";return t==="right"&&(n="eln-ln-right"),t==="left-offset"&&(n="eln-ln-left-offset"),a.EditorView.editorAttributes.of({class:n,style:`--eln-offset: ${i}px;`})}getAlignExtension(t){let i="eln-align-right";return t==="left"&&(i="eln-align-left"),t==="center"&&(i="eln-align-center"),a.EditorView.editorAttributes.of({class:i})}async loadSettings(){this.settings=Object.assign({},w,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.applyToAllOpenEditors()}applyToAllOpenEditors(){let t=this.getLineNumbersExtension(this.settings.enabled),i=this.getPositionExtension(this.settings.position,this.settings.offset),n=this.getAlignExtension(this.settings.align);this.app.workspace.iterateAllLeaves(u=>{let m=u.view;if(!(m instanceof s.MarkdownView))return;let g=m.editor,p=g==null?void 0:g.cm;if(!(!p||typeof p.dispatch!="function"))try{p.dispatch({effects:[this.lineNumberCompartment.reconfigure(t),this.positionCompartment.reconfigure(i),this.alignCompartment.reconfigure(n)]})}catch(y){}})}},f=class extends s.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Editor Line Number"}),new s.Setting(e).setName("\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u043D\u0443\u043C\u0435\u0440\u0430\u0446\u0438\u044E \u0441\u0442\u0440\u043E\u043A").addToggle(t=>t.setValue(this.plugin.settings.enabled).onChange(async i=>{this.plugin.settings.enabled=i,await this.plugin.saveSettings()})),new s.Setting(e).setName("\u041F\u043E\u043B\u043E\u0436\u0435\u043D\u0438\u0435").addDropdown(t=>t.addOption("left","\u0421\u043B\u0435\u0432\u0430").addOption("left-offset","\u0421\u043B\u0435\u0432\u0430 \u0441 \u043E\u0442\u0441\u0442\u0443\u043F\u043E\u043C").addOption("right","\u0421\u043F\u0440\u0430\u0432\u0430").setValue(this.plugin.settings.position).onChange(async i=>{this.plugin.settings.position=i,await this.plugin.saveSettings()})),new s.Setting(e).setName("\u041E\u0442\u0441\u0442\u0443\u043F (px)").setDesc("\u0420\u0430\u0431\u043E\u0442\u0430\u0435\u0442 \u0434\u043B\u044F \u0440\u0435\u0436\u0438\u043C\u0430 '\u0421\u043B\u0435\u0432\u0430 \u0441 \u043E\u0442\u0441\u0442\u0443\u043F\u043E\u043C'").addSlider(t=>t.setLimits(0,120,5).setDynamicTooltip().setValue(this.plugin.settings.offset).onChange(async i=>{this.plugin.settings.offset=i,await this.plugin.saveSettings()})),new s.Setting(e).setName("\u0412\u044B\u0440\u0430\u0432\u043D\u0438\u0432\u0430\u043D\u0438\u0435 \u0446\u0438\u0444\u0440").setDesc("\u041A\u0430\u043A \u0432 VS Code \u0438\u043B\u0438 \u043A\u043B\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043A\u043E\u0435").addDropdown(t=>t.addOption("right","\u0421\u043F\u0440\u0430\u0432\u0430 (VS Code)").addOption("left","\u0421\u043B\u0435\u0432\u0430").addOption("center","\u041F\u043E \u0446\u0435\u043D\u0442\u0440\u0443").setValue(this.plugin.settings.align).onChange(async i=>{this.plugin.settings.align=i,await this.plugin.saveSettings()}))}};
